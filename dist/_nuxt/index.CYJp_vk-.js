import{_ as Y}from"./Label.vue.qd5PwVlU.js";import{_ as G}from"./Input.vue.A2ISKsCv.js";import{b as R,a as X,e as H,f as J,d as K,c as Q,_ as W}from"./SelectScrollDownButton.vue.C3j1_HRC.js";import{j as p,B as N,y as Z,a as h,h as l,w as o,f as i,k as z,o as f,l as d,t as u,u as n,b as v,F as k,x as w,c as q,q as ee,s as le}from"./entry.CM4UmRmh.js";import{p as x}from"./profileService.DaeCWTY_.js";import{_ as ae}from"./index.DNzJp8SU.js";import"./tokenService.Cdn6yuQ_.js";import"./authService.BBKLY34u.js";const te=i("h4",{class:"text-base sm:text-xl font-semibold mb-4"},"Asosiy malumotlar",-1),oe=["onSubmit"],ne={class:"grid gap-3 sm:gap-6 grid-cols-1 md:grid-cols-2 lg:grid-cols-3 mb-8"},se={class:"flex flex-col"},ie={class:"text-xs text-red-600"},de={class:"flex flex-col"},re={class:"text-xs text-red-600"},ue={class:"flex flex-col"},me={class:"text-xs text-red-600"},ce={class:"flex flex-col"},fe={class:"text-xs text-red-600"},_e={class:"flex flex-col"},pe={class:"text-xs text-red-600"},ve={class:"flex flex-col"},he={class:"relative w-full"},xe=i("span",{class:"absolute top-1/2 -translate-y-1/2 start-0 flex items-center justify-center px-3"}," 998 ",-1),ge={class:"text-xs text-red-600"},Ve={class:"flex flex-col"},ye={class:"flex flex-col"},be={class:"flex flex-col"},Se={class:"flex flex-col"},Ce={__name:"index",setup(Ue){const{$toast:B}=le(),C=p({options:[]}),T=p({options:[]}),E=p({options:[]}),a=p({username:"",first_name:"",last_name:"",father_name:"",birth_date:"",district:"",school:"",type:"applicant",region:"",balance:"",phone:"",email:""}),A=p([{value:"applicant",name:"Abituriyent"},{value:"pupil",name:"O'quvchi"},{value:"teacher",name:"O'qituvchi"}]),g=p(!1);async function D(){try{const s=await x.regions();C.value.options=s}catch(s){console.error("Error fetching user:",s)}}async function I(s){try{const t=await x.districts(s);T.value.options=t}catch(t){console.error("Error fetching districts:",t)}}async function L(s){try{const t=await x.schools(s);E.value.options=t}catch(t){console.error("Error fetching schools:",t)}}async function M(){g.value=!0;try{const s=await x.user();a.value=s,a.value.phone=s.phone.slice(3),a.value.region=s.region.id.toString(),a.value.district=s.district.id.toString(),a.value.school=s.school.id.toString(),E.value.id=s.school.id.toString()}catch(s){console.error("Error fetching user:",s)}finally{g.value=!1}}async function O(){g.value=!0;let s=new FormData;s.append("username",a.value.username),s.append("first_name",a.value.first_name),s.append("last_name",a.value.last_name),s.append("father_name",a.value.father_name),s.append("email",a.value.email),s.append("district",a.value.district),s.append("school",a.value.school),s.append("type",a.value.type),s.append("phone","998"+a.value.phone);try{const t=await x.updateProfile(s);t.error||(a.value=t,M(),B.success("Profile muvaffaqiyatli o`zgartirildi"))}catch(t){B.error("Xatolik yuz berdi",t)}finally{g.value=!1}}return N(()=>a.value.region,async(s,t)=>{s!==t&&I(s)}),N(()=>a.value.district,async(s,t)=>{s!==t&&L(s)}),Z(()=>{M(),D()}),(s,t)=>{const m=Y,_=G,c=z("VField"),V=R,y=X,b=H,S=J,U=K,F=Q,$=W,P=z("VForm");return f(),h("div",null,[te,l(P,null,{default:o(({handleSubmit:j})=>[d(u(n(T).id)+" ",1),i("form",{onSubmit:ee(e=>j(O),["prevent"])},[i("div",null,[i("div",ne,[i("div",se,[l(c,{name:"username",rules:"required|max:60|min:3",modelValue:n(a).username,"onUpdate:modelValue":t[1]||(t[1]=e=>n(a).username=e)},{default:o(({errors:e})=>[l(m,{for:"username"},{default:o(()=>[d("Foydalanuvchi nomi")]),_:1}),l(_,{id:"username",type:"text",placeholder:"Fodalanuvchi nomi",class:v(e.length>0?"focus-visible:border-red-600 border-red-600":""),modelValue:n(a).username,"onUpdate:modelValue":t[0]||(t[0]=r=>n(a).username=r)},null,8,["class","modelValue"]),i("span",ie,u(e[0]),1)]),_:1},8,["modelValue"])]),i("div",de,[l(c,{name:"first_name",rules:"required|max:60|min:3",modelValue:n(a).first_name,"onUpdate:modelValue":t[3]||(t[3]=e=>n(a).first_name=e)},{default:o(({errors:e})=>[l(m,{for:"first_name"},{default:o(()=>[d("Ism")]),_:1}),l(_,{id:"first_name",type:"text",placeholder:"Fodalanuvchi nomi",modelValue:n(a).first_name,"onUpdate:modelValue":t[2]||(t[2]=r=>n(a).first_name=r),class:v(e.length>0?"focus-visible:border-red-600 border-red-600":"")},null,8,["modelValue","class"]),i("span",re,u(e[0]),1)]),_:1},8,["modelValue"])]),i("div",ue,[l(c,{name:"last_name",rules:"required|max:60|min:3",modelValue:n(a).last_name,"onUpdate:modelValue":t[5]||(t[5]=e=>n(a).last_name=e)},{default:o(({errors:e})=>[l(m,{for:"last_name"},{default:o(()=>[d("Familiya")]),_:1}),l(_,{id:"last_name",type:"text",placeholder:"Fodalanuvchi nomi",modelValue:n(a).last_name,"onUpdate:modelValue":t[4]||(t[4]=r=>n(a).last_name=r),class:v(e.length>0?"focus-visible:border-red-600 border-red-600":"")},null,8,["modelValue","class"]),i("span",me,u(e[0]),1)]),_:1},8,["modelValue"])]),i("div",ce,[l(c,{name:"father_name",rules:"max:60|min:3",modelValue:n(a).father_name,"onUpdate:modelValue":t[7]||(t[7]=e=>n(a).father_name=e)},{default:o(({errors:e})=>[l(m,{for:"father_name"},{default:o(()=>[d("Otasining ismi")]),_:1}),l(_,{id:"father_name",type:"text",placeholder:"Fodalanuvchi nomi",modelValue:n(a).father_name,"onUpdate:modelValue":t[6]||(t[6]=r=>n(a).father_name=r),class:v(e.length>0?"focus-visible:border-red-600 border-red-600":"")},null,8,["modelValue","class"]),i("span",fe,u(e[0]),1)]),_:1},8,["modelValue"])]),i("div",_e,[l(c,{name:"email",rules:"email",modelValue:n(a).email,"onUpdate:modelValue":t[9]||(t[9]=e=>n(a).email=e)},{default:o(({errors:e})=>[l(m,{for:"email"},{default:o(()=>[d("Email")]),_:1}),l(_,{id:"email",type:"text",placeholder:"Fodalanuvchi nomi",modelValue:n(a).email,"onUpdate:modelValue":t[8]||(t[8]=r=>n(a).email=r),class:v(e.length>0?"focus-visible:border-red-600 border-red-600":"")},null,8,["modelValue","class"]),i("span",pe,u(e[0]),1)]),_:1},8,["modelValue"])]),i("div",ve,[l(c,{name:"phone",rules:"phone|max:9",modelValue:n(a).phone,"onUpdate:modelValue":t[11]||(t[11]=e=>n(a).phone=e)},{default:o(({errors:e})=>[l(m,{for:"phone"},{default:o(()=>[d("Telefon raqam")]),_:1}),i("div",he,[l(_,{id:"phone",type:"text",placeholder:"Telefon raqam",modelValue:n(a).phone,"onUpdate:modelValue":t[10]||(t[10]=r=>n(a).phone=r),class:v(["pl-12",e.length>0?"focus-visible:border-red-600 border-red-600":""])},null,8,["modelValue","class"]),xe]),i("span",ge,u(e[0]),1)]),_:1},8,["modelValue"])]),i("div",Ve,[l(c,{name:"region"},{default:o(()=>[l(m,{for:"region"},{default:o(()=>[d("Yo'nalishni tanlang")]),_:1}),l($,{modelValue:n(a).type,"onUpdate:modelValue":t[12]||(t[12]=e=>n(a).type=e)},{default:o(()=>[l(y,null,{default:o(()=>[l(V,{placeholder:"Yo'nalishni tanlang"})]),_:1}),l(F,null,{default:o(()=>[l(U,null,{default:o(()=>[l(b,null,{default:o(()=>[d("Tanlang")]),_:1}),(f(!0),h(k,null,w(n(A),(e,r)=>(f(),q(S,{key:r+2,value:e.value},{default:o(()=>[d(u(e.name),1)]),_:2},1032,["value"]))),128))]),_:1})]),_:1})]),_:1},8,["modelValue"])]),_:1})]),i("div",ye,[l(c,{name:"region"},{default:o(()=>[l(m,{for:"region"},{default:o(()=>[d("Viloyatni tanlang")]),_:1}),l($,{modelValue:n(a).region,"onUpdate:modelValue":t[13]||(t[13]=e=>n(a).region=e)},{default:o(()=>[l(y,null,{default:o(()=>[l(V,{placeholder:"Viloyatni tanlang"})]),_:1}),l(F,null,{default:o(()=>[l(U,null,{default:o(()=>[l(b,null,{default:o(()=>[d("Tanlang")]),_:1}),(f(!0),h(k,null,w(n(C).options,(e,r)=>(f(),q(S,{key:r+2,value:e.id.toString()},{default:o(()=>[d(u(e.name),1)]),_:2},1032,["value"]))),128))]),_:1})]),_:1})]),_:1},8,["modelValue"])]),_:1})]),i("div",be,[l(c,{name:"district"},{default:o(()=>[l(m,{for:"district"},{default:o(()=>[d("Tumanni tanlang")]),_:1}),l($,{modelValue:n(a).district,"onUpdate:modelValue":t[14]||(t[14]=e=>n(a).district=e),disabled:n(a).region===""},{default:o(()=>[l(y,null,{default:o(()=>[l(V,{placeholder:"Tumanni tanlang"})]),_:1}),l(F,null,{default:o(()=>[l(U,null,{default:o(()=>[l(b,null,{default:o(()=>[d("Tanlang")]),_:1}),(f(!0),h(k,null,w(n(T).options,e=>(f(),q(S,{key:e.id,value:e.id.toString()},{default:o(()=>[d(u(e.name),1)]),_:2},1032,["value"]))),128))]),_:1})]),_:1})]),_:1},8,["modelValue","disabled"])]),_:1})]),i("div",Se,[l(c,{name:"school"},{default:o(()=>[l(m,{for:"school"},{default:o(()=>[d("Maktabni tanlang")]),_:1}),l($,{modelValue:n(a).school,"onUpdate:modelValue":t[15]||(t[15]=e=>n(a).school=e),disabled:n(a).district===""},{default:o(()=>[l(y,null,{default:o(()=>[l(V,{placeholder:"Maktabni tanlang"})]),_:1}),l(F,null,{default:o(()=>[l(U,null,{default:o(()=>[l(b,null,{default:o(()=>[d("Tanlang")]),_:1}),(f(!0),h(k,null,w(n(E).options,e=>(f(),q(S,{key:e.id,value:e.id.toString()},{default:o(()=>[d(u(e.name),1)]),_:2},1032,["value"]))),128))]),_:1})]),_:1})]),_:1},8,["modelValue","disabled"])]),_:1})])]),l(n(ae),{type:"submit",class:"w-full sm:w-auto"},{default:o(()=>[d("Saqlash")]),_:1})])],40,oe)]),_:1})])}}};export{Ce as default};
