import{u as c}from"./useApi.BoEt07ES.js";import{c as f}from"./entry.DdJuc-3z.js";import{a as p}from"./swiper-vue.DvdnvJXd.js";const y=()=>{const u=c(),e=p({}),t=p(!1),{$toast:s}=f(),n=async()=>{var l,r,o,i;t.value=!0;try{const a=await u.get("users/profile/");e.value=a,e.value.phone=(l=a==null?void 0:a.phone)==null?void 0:l.slice(3),e.value.region=(r=a==null?void 0:a.region)==null?void 0:r.id,e.value.district=(o=a==null?void 0:a.district)==null?void 0:o.id,e.value.school=(i=a==null?void 0:a.school)==null?void 0:i.id}catch(a){console.error(a)}finally{t.value=!1}};return{user:e,loading:t,userProfile:n,updateUserProfile:async()=>{t.value=!0;const l=new FormData;l.append("first_name",e.value.first_name),l.append("last_name",e.value.last_name),e.value.username!==null&&l.append("username",e.value.username),e.value.phone!==null&&l.append("phone","998"+e.value.phone),e.value.father_name!==null&&l.append("father_name",e.value.father_name),e.value.birth_date!==null&&l.append("birth_date",e.value.birth_date),e.value.email!==null&&l.append("email",e.value.email),e.value.district!==null&&l.append("district",e.value.district),e.value.school!==null&&l.append("school",e.value.school),e.value.photo!==null&&l.append("photo",e.value.photo),l.append("type",e.value.type);try{const r=await u.patch("users/profile/",l);e.value=r,n(),s.success("Profile muvaffaqiyatli o`zgartirildi")}catch(r){if(r.response&&r.response.data){const o=r.response.data;Object.keys(o).forEach(i=>{const a=`${i}: ${o[i].join(", ")}`;s.error(a)})}else r.message?s.error(r.message):s.error("Aniq xatolik haqida ma'lumot yo'q")}finally{t.value=!1}}}};export{y as u};
