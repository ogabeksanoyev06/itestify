import{u as c}from"./useApi.DC8F9R_R.js";import{c as f}from"./entry.T61pW6s4.js";import{a as p}from"./swiper-vue.f8ijT8wh.js";const g=()=>{const n=c(),e=p({}),o=p(!1),{$toast:s}=f(),u=async()=>{var l,r,t,i;o.value=!0;try{const a=await n.get("users/profile/");e.value=a,e.value.phone=a.phone?(l=a==null?void 0:a.phone)==null?void 0:l.slice(3):a.phone,e.value.region=a.region?(r=a==null?void 0:a.region)==null?void 0:r.id:a.region,e.value.district=a.district?(t=a==null?void 0:a.district)==null?void 0:t.id:a.district,e.value.school=a.school?(i=a==null?void 0:a.school)==null?void 0:i.id:a.school}catch(a){console.error(a)}finally{o.value=!1}};return{user:e,loading:o,userProfile:u,updateUserProfile:async()=>{o.value=!0;const l=new FormData;l.append("first_name",e.value.first_name),l.append("last_name",e.value.last_name),e.value.username!==null&&l.append("username",e.value.username),e.value.phone!==null&&l.append("phone","998"+e.value.phone),e.value.father_name!==null&&l.append("father_name",e.value.father_name),e.value.birth_date!==null&&l.append("birth_date",e.value.birth_date),e.value.email!==null&&l.append("email",e.value.email),e.value.district!==null&&l.append("district",e.value.district),e.value.school!==null&&l.append("school",e.value.school),e.value.photo!==null&&l.append("photo",e.value.photo),l.append("type",e.value.type);try{const r=await n.patch("users/profile/",l);e.value=r,u(),s.success("Profile muvaffaqiyatli o`zgartirildi")}catch(r){if(r.response&&r.response.data){const t=r.response.data;Object.keys(t).forEach(i=>{const a=`${i}: ${t[i].join(", ")}`;s.error(a)})}else r.message?s.error(r.message):s.error("Aniq xatolik haqida ma'lumot yo'q")}finally{o.value=!1}}}};export{g as u};
